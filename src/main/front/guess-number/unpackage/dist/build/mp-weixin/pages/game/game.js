(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/game/game"],{"774e":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("a34a")),s=n("2f62");function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,o,s,i,a){try{var r=e[i](a),c=r.value}catch(u){return void n(u)}r.done?t(c):Promise.resolve(c).then(o,s)}function r(e){return function(){var t=this,n=arguments;return new Promise(function(o,s){var i=e.apply(t,n);function r(e){a(i,o,s,r,c,"next",e)}function c(e){a(i,o,s,r,c,"throw",e)}r(void 0)})}}var c={computed:(0,s.mapState)(["islogin","openid","username","auth","urlpath"]),data:function(){return{is_open_socket:!1,socketTask:null,is_init:!0,is_matching:!1,is_matched:!1,is_round:!1,modalName:null,resdata:null,result:50,otherUsername:"旗鼓相当的对手",otherUserOpenId:-1,otheruserscore:0,mya:-1,myb:101,myina:-1,myinb:101,othera:101,otherb:-1}},onLoad:function(){},mounted:function(){console.log("mounted"),this.connectSocket()},beforeDestroy:function(){this.closeSocket()},methods:{connectSocket:function(){var t=this,n="ws://"+this.urlpath+":8800/guessNumber";this.socketTask=e.connectSocket({url:n,success:function(e){console.log("websocket连接成功")}});var s=this,i='login={"openid":"'+this.openid+'","nickname":"'+this.username+'"}';this.socketTask.onOpen(function(e){console.log("WebSocket连接正常打开中..."),t.is_open_socket=!0,t.socketTask.send({data:i,success:function(){var e=r(o.default.mark(function e(){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("连接建立成功...");case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}),t.socketTask.onMessage(function(e){if(console.log("收到服务器消息"),"loginok"==e.data);else if("win"==e.data||"lose"==e.data||"error"==e.data)"error"==e.data&&(s.modalName="error"),s.modalName=e.data,s.is_init=!0,s.is_matching=!1,s.is_matched=!1,s.is_round=!1,s.mya=-1,s.myb=101,s.othera=101,s.otherb=-1,s.otherUsername="旗鼓相当的对手",s.otherUserOpenId=-1,s.otheruserscore=0,s.otherUserOpenId=-1;else{s.resdata=e.data;var t=JSON.parse(s.resdata);console.log(t),1==t.code?(console.log(t),s.modalName="Image",s.is_matching=!1,s.is_matched=!0,s.result=t.res,s.otherUserOpenId=t.openid,s.otherUsername=t.nickname,s.otheruserscore=t.score,s.otherUserOpenId<s.openid&&(s.is_round=!0)):2==t.code&&(s.is_round=!0,s.othera=t.numbera,s.otherb=t.numberb)}})}),this.socketTask.onClose(function(){console.log("已经被关闭了")})},closeSocket:function(){this.socketTask.close({success:function(e){this.is_open_socket=!1,console.log("websocket关闭成功",e)},fail:function(e){console.log("websocket关闭失败",e)}})},clickRequest:function(){if(this.is_open_socket){this.is_init=!1,this.is_matching=!0;var e='match={"openid":"'+this.openid+'","nickname":"'+this.username+'"}';this.socketTask.send({data:e,success:function(){var e=r(o.default.mark(function e(t){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()})}},confirmnumber:function(){if(this.mya=this.myina,this.myb=this.myinb,this.is_round=!this.is_round,console.log(this.mya+" "+this.myb),this.mya==this.result||this.myb==this.result){var e='win={"openid":"'+this.openid+'"}';this.socketTask.send({data:e,success:function(){var e=r(o.default.mark(function e(t){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()})}else{var t='number={"openid":"'+this.otherUserOpenId+'","numbera":"'+this.mya+'","numberb":"'+this.myb+'"}';this.socketTask.send({data:t,success:function(){var e=r(o.default.mark(function e(t){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()})}},inputA:function(e){this.myina=e.target.value},inputB:function(e){this.myinb=e.target.value},showModal:function(e){this.modalName=e.currentTarget.dataset.target},hideModal:function(e){this.modalName=null}}};t.default=c}).call(this,n("543d")["default"])},a460:function(e,t,n){"use strict";(function(e){n("3300"),n("921b");o(n("66fd"));var t=o(n("c926"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},c926:function(e,t,n){"use strict";n.r(t);var o=n("df4d"),s=n("f750");for(var i in s)"default"!==i&&function(e){n.d(t,e,function(){return s[e]})}(i);var a=n("2877"),r=Object(a["a"])(s["default"],o["a"],o["b"],!1,null,null,null);t["default"]=r.exports},df4d:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s})},f750:function(e,t,n){"use strict";n.r(t);var o=n("774e"),s=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);t["default"]=s.a}},[["a460","common/runtime","common/vendor"]]]);